/** 
 * @fileoverview This file work with product attributes
 * @author Igor Zhabskiy <Igor.Zhabskiy.@gmail.com>
 * @version 0.1
 */
var flag=0;
var isEven = function(someNumber) {
  return (someNumber % 2 == 0) ? true : false;
};
function m_attributes_price() {
    var bb = $(".product-options-table .btn-default.active");
    if(!(isEven(flag))){var qq = $(bb).parent().parent().find(':first-child')
        var tt = qq[0];
        var qss = $(tt).text();
        var tts = "";
        var vval = "";
        qss = qss.replace(/\s+/g, '');
        symbb = qss.charAt(0);
        if(symbb == "1"){
              tts = "6500";
            vval = "46";
        }
        if(symbb == "4"){
              tts = "3500";
            vval = "17";
        }
        if(symbb == "6"){
              tts = "4500";
            vval = "44";
        }
        if(symbb == "8"){
              tts = "5500";
            vval = "45";
        }
        tts = tts + ".00 р.";
        var my = $("#additional_checkbox_4");
        $(my).attr("value", vval);
        $(my).parent().parent().next().text(tts);
    }
    flag++;
    if (window.XMLHttpRequest) { 
    req = new XMLHttpRequest(); 
    } else if (window.ActiveXObject) { 
    req = new ActiveXObject("Microsoft.XMLHTTP"); 
    }
    if (req) {
        var inputs = document.getElementsByTagName('input');
        var values_radio = values_checkbox = '';
        for (var i = 0; i < inputs.length; i++) {
			if (inputs[i].type === 'radio' && inputs[i].checked) { values_radio += inputs[i].value + ':'; }
			if (inputs[i].type === 'checkbox' && inputs[i].value !== "" && inputs[i].checked) {
                if (inputs[i].value!='on') {
    				values_checkbox += inputs[i].value + ',';
	            }
				if (inputs[i+1] && inputs[i+1].type === 'text') {
					values_checkbox += inputs[i+1].value + ':';
				}
			}
        }
        var clean_price = document.getElementById('clean_price');
        var clean_discount = document.getElementById('clean_discount');
        var current_price = document.getElementById('current_price');
        var current_discount = document.getElementById('current_discount');
        var category = $('.product-title').text();
        //console.log(category);
        if (category.includes('Теплица') && ((category.includes('Агро') == false) || (category.includes('Премиум') == false)))
        {
            var cat = 1;
        } else  {
            var cat = 0;
        }
        //console.log(cat);
        var params = 'mode=change_price&values_radio=' + values_radio + '&values_checkbox=' + values_checkbox + '&cleanprice=' + clean_price.value + '&cleandiscount=' + clean_discount.value + '&cat='+cat;
        var url = "/modules/product_attributes/m_ajax.php";
       	req.onreadystatechange = function() {
            if (req.readyState == 4) { 
                if(req.status == 200) {
                    temp_data = req.responseText.split('{}');
                    current_price.innerHTML = temp_data[0];
                    current_discount.innerHTML = temp_data[1];
                }
            }
        }
    }
    req.open("POST", url, true); 
    req.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); 
    req.setRequestHeader('Content-length', params.length); 
    req.send(params);

}